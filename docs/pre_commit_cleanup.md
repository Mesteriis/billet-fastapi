# üßπ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –æ—á–∏—Å—Ç–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞ —Å Pre-Commit

## üìã –û–±–∑–æ—Ä

–ü—Ä–æ–µ–∫—Ç –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω —Å [pre-commit](https://pre-commit.com/) –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—á–∏—Å—Ç–∫–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –∏ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ –ø–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–∞–º–∏. –≠—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –≤ —á–∏—Å—Ç–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –∏ –∏–∑–±–µ–≥–∞—Ç—å –∫–æ–º–º–∏—Ç–æ–≤ –Ω–µ–Ω—É–∂–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤.

## üéØ –†–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã

### 1. Dry-Run (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)

–ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∫–æ–º–º–∏—Ç–µ, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —á—Ç–æ –±—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω–æ –±–µ–∑ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è:

```bash
git commit -m "fix: –≤–∞–∂–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ"
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è preview –æ—á–∏—Å—Ç–∫–∏
```

### 2. –ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞

–ê–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤:

```bash
# –ß–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è
PRECOMMIT_CLEANUP=full git commit -m "feat: –Ω–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è"

# –ò–ª–∏ –æ—Ç–¥–µ–ª—å–Ω–æ
make pre-commit-cleanup-full
```

### 3. –ü–æ–¥—Ä–æ–±–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞

–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–∞–∂–¥–æ–º —É–¥–∞–ª—è–µ–º–æ–º —Ñ–∞–π–ª–µ:

```bash
# –ß–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è
PRECOMMIT_CLEANUP=verbose git commit -m "docs: –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏"

# –ò–ª–∏ –æ—Ç–¥–µ–ª—å–Ω–æ
make pre-commit-cleanup-verbose
```

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ö—É–∫–æ–≤

–í `.pre-commit-config.yaml` –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ —Ö—É–∫–∏:

```yaml
# –ë—ã—Å—Ç—Ä–∞—è –æ—á–∏—Å—Ç–∫–∞ –≤ —Ä–µ–∂–∏–º–µ dry-run (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- id: cleanup-project-dry
  name: Project Cleanup (Dry Run)
  entry: python scripts/cleanup_project.py
  args: ["--dry-run"]
  stages: [pre-commit]

# –ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ (PRECOMMIT_CLEANUP=full)
- id: cleanup-project-full
  name: Project Cleanup (Full)
  stages: [manual]

# –ü–æ–¥—Ä–æ–±–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ (PRECOMMIT_CLEANUP=verbose)
- id: cleanup-project-verbose
  name: Project Cleanup (Verbose)
  stages: [manual]
```

## üöÄ –ö–æ–º–∞–Ω–¥—ã Makefile

–î–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –¥–æ–±–∞–≤–ª–µ–Ω—ã —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:

```bash
# –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –æ—á–∏—Å—Ç–∫–∏ —á–µ—Ä–µ–∑ pre-commit
make pre-commit-cleanup-dry

# –ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ —á–µ—Ä–µ–∑ pre-commit
make pre-commit-cleanup-full

# –ü–æ–¥—Ä–æ–±–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ —á–µ—Ä–µ–∑ pre-commit
make pre-commit-cleanup-verbose

# –û–±—ã—á–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ (–Ω–µ —á–µ—Ä–µ–∑ pre-commit)
make clean
```

## üìä –ß—Ç–æ –æ—á–∏—â–∞–µ—Ç—Å—è

–•—É–∫–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç `scripts/cleanup_project.py` –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ —É–¥–∞–ª—è—é—Ç:

### ‚úÖ –£–¥–∞–ª—è–µ—Ç—Å—è:

- `__pycache__/` - –∫–µ—à Python
- `.pytest_cache/` - –∫–µ—à pytest
- `.mypy_cache/` - –∫–µ—à mypy
- `.ruff_cache/` - –∫–µ—à Ruff
- `htmlcov/` - –æ—Ç—á–µ—Ç—ã –ø–æ–∫—Ä—ã—Ç–∏—è HTML
- `.coverage*` - —Ñ–∞–π–ª—ã –ø–æ–∫—Ä—ã—Ç–∏—è
- `*.pyc, *.pyo` - —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ Python —Ñ–∞–π–ª—ã
- `.DS_Store` - —Ñ–∞–π–ª—ã macOS
- `*.tmp, *.temp` - –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
- `reports/*.html` - HTML –æ—Ç—á–µ—Ç—ã

### ‚ùå –ù–ï —É–¥–∞–ª—è–µ—Ç—Å—è:

- `.venv/`, `venv/` - –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- `node_modules/` - –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Node.js
- `src/`, `tests/` - –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥
- `.git/` - —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π Git
- `migrations/` - –º–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
- `backups/` - –≤–∞–∂–Ω—ã–µ –±—ç–∫–∞–ø—ã

## üîß –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è          | –ó–Ω–∞—á–µ–Ω–∏–µ       | –û–ø–∏—Å–∞–Ω–∏–µ                               |
| ------------------- | -------------- | -------------------------------------- |
| `PRECOMMIT_CLEANUP` | `full`         | –í–∫–ª—é—á–∞–µ—Ç –ø–æ–ª–Ω—É—é –æ—á–∏—Å—Ç–∫—É –ø—Ä–∏ –∫–æ–º–º–∏—Ç–µ    |
| `PRECOMMIT_CLEANUP` | `verbose`      | –í–∫–ª—é—á–∞–µ—Ç –ø–æ–¥—Ä–æ–±–Ω—É—é –æ—á–∏—Å—Ç–∫—É –ø—Ä–∏ –∫–æ–º–º–∏—Ç–µ |
| `PRECOMMIT_CLEANUP` | –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ | –¢–æ–ª—å–∫–æ dry-run —Ä–µ–∂–∏–º (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)    |

## üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –û–±—ã—á–Ω—ã–π workflow (—Ç–æ–ª—å–∫–æ preview)

```bash
git add .
git commit -m "feat: –Ω–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è"
# –í—ã–≤–æ–¥: üîç –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –æ—á–∏—Å—Ç–∫–∏: –Ω–∞–π–¥–µ–Ω–æ 5 —Ñ–∞–π–ª–æ–≤ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è
```

### –ö–æ–º–º–∏—Ç —Å –ø–æ–ª–Ω–æ–π –æ—á–∏—Å—Ç–∫–æ–π

```bash
git add .
PRECOMMIT_CLEANUP=full git commit -m "feat: –Ω–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è"
# –í—ã–≤–æ–¥: üßπ –û—á–∏—Å—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞: —É–¥–∞–ª–µ–Ω–æ 5 —Ñ–∞–π–ª–æ–≤, –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–æ 2.3 MB
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –≤–∞–∂–Ω—ã–º –∫–æ–º–º–∏—Ç–æ–º

```bash
# –°–Ω–∞—á–∞–ª–∞ –ø–æ—Å–º–æ—Ç—Ä–∏–º —á—Ç–æ –±—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω–æ
make pre-commit-cleanup-verbose

# –ï—Å–ª–∏ –≤—Å—ë –û–ö, –¥–µ–ª–∞–µ–º –ø–æ–ª–Ω—É—é –æ—á–∏—Å—Ç–∫—É –∏ –∫–æ–º–º–∏—Ç
PRECOMMIT_CLEANUP=full git commit -m "release: v1.2.0"
```

### –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –∞–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∏ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–æ–º–º–∏—Ç–∞

```bash
# –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ö—É–∫–∏ –æ—á–∏—Å—Ç–∫–∏
git commit -m "wip: –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è" --no-verify
```

## üéõÔ∏è –ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ–≤–µ–¥–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ, —á—Ç–æ–±—ã –ø–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –≤—ã–ø–æ–ª–Ω—è–ª–∞—Å—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –∏–∑–º–µ–Ω–∏—Ç–µ –≤ `.pre-commit-config.yaml`:

```yaml
# –ë—ã–ª–æ
stages: [pre-commit]  # –¥–ª—è dry-run
stages: [manual]      # –¥–ª—è full

# –°—Ç–∞–Ω–µ—Ç
stages: [manual]      # –¥–ª—è dry-run
stages: [pre-commit]  # –¥–ª—è full
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª –æ—á–∏—Å—Ç–∫–∏

1. –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `scripts/cleanup_project.py`
2. –î–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –≤ `directories_to_remove` –∏–ª–∏ `file_patterns_to_remove`
3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Å `--dry-run`

## üö® –ú–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

1. **–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ç–æ–ª—å–∫–æ preview** - —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —Ç—Ä–µ–±—É–µ—Ç —è–≤–Ω–æ–≥–æ —É–∫–∞–∑–∞–Ω–∏—è
2. **–ó–∞—â–∏—â–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã** - –≤–∞–∂–Ω—ã–µ —Ñ–∞–π–ª—ã –∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –∑–∞—â–∏—â–µ–Ω—ã –æ—Ç —É–¥–∞–ª–µ–Ω–∏—è
3. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
4. **Dry-run —Ä–µ–∂–∏–º** - –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞

## üîç –û—Ç–ª–∞–¥–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ –±—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω–æ

```bash
make pre-commit-cleanup-dry
# –∏–ª–∏
python scripts/cleanup_project.py --dry-run
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö —Ö—É–∫–æ–≤

```bash
pre-commit run --all-files --verbose
```

### –ó–∞–ø—É—Å–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ö—É–∫–∞

```bash
pre-commit run cleanup-project-dry
pre-commit run cleanup-project-full --hook-stage manual
```

## üìà –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å CI/CD

–í CI –æ–∫—Ä—É–∂–µ–Ω–∏—è—Ö —Ö—É–∫–∏ –æ—á–∏—Å—Ç–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–ø—É—Å–∫–∞—é—Ç—Å—è –±–ª–∞–≥–æ–¥–∞—Ä—è:

1. **–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏—é CI** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö `CI`, `GITHUB_ACTIONS`, –∏ –¥—Ä.
2. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞–º pre-commit.ci** - –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –≤ `.pre-commit-config.yaml`:

```yaml
ci:
  skip: [cleanup-project-dry, cleanup-project-full, cleanup-project-verbose]
```

## üéØ –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

1. **–†–µ–≥—É–ª—è—Ä–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞** - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `make clean` –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏
2. **–ü–µ—Ä–µ–¥ —Ä–µ–ª–∏–∑–æ–º** - –≤—ã–ø–æ–ª–Ω—è–π—Ç–µ –ø–æ–ª–Ω—É—é –æ—á–∏—Å—Ç–∫—É —Å `--verbose`
3. **–í –∫–æ–º–∞–Ω–¥–µ** - –¥–æ–≥–æ–≤–æ—Ä–∏—Ç–µ—Å—å –æ –µ–¥–∏–Ω–æ–º –ø–æ–¥—Ö–æ–¥–µ –∫ –æ—á–∏—Å—Ç–∫–µ
4. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - —Å–ª–µ–¥–∏—Ç–µ –∑–∞ —Ä–∞–∑–º–µ—Ä–æ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

- `.pre-commit-config.yaml` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ö—É–∫–æ–≤
- `scripts/cleanup_project.py` - —Å–∫—Ä–∏–ø—Ç –æ—á–∏—Å—Ç–∫–∏
- `tests/conftest.py` - –∞–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞ –≤ —Ç–µ—Å—Ç–∞—Ö
- `Makefile` - –∫–æ–º–∞–Ω–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- `docs/project_cleanup.md` - –æ–±—â–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –æ—á–∏—Å—Ç–∫–µ
