# üîß –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é Pre-commit

## üö® **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (—Ç—Ä–µ–±—É—é—Ç –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ –≤–Ω–∏–º–∞–Ω–∏—è)**

### 1. MD5 –≤ production –∫–æ–¥–µ

```python
# ‚ùå –ù–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ (src/realtime/models.py:131)
checksum = hashlib.md5(data).hexdigest()

# ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å –Ω–∞:
checksum = hashlib.md5(data, usedforsecurity=False).hexdigest()
# –ò–õ–ò –ª—É—á—à–µ:
checksum = hashlib.sha256(data).hexdigest()
```

### 2. –ö–∏—Ä–∏–ª–ª–∏—á–µ—Å–∫–∏–µ —Å–∏–º–≤–æ–ª—ã –≤ –∫–æ–¥–µ

```python
# ‚ùå –ü—Ä–æ–±–ª–µ–º–∞ - —Å–º–µ—à–µ–Ω–∏–µ –∞–ª—Ñ–∞–≤–∏—Ç–æ–≤
"""–¢–µ—Å—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏."""  # —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–∏—Ä–∏–ª–ª–∏—á–µ—Å–∫—É—é '—Å'

# ‚úÖ –†–µ—à–µ–Ω–∏—è:
# –í–∞—Ä–∏–∞–Ω—Ç 1: –¢–æ–ª—å–∫–æ –∞–Ω–≥–ª–∏–π—Å–∫–∏–π
"""Test functionality with parameters."""

# –í–∞—Ä–∏–∞–Ω—Ç 2: –ß–∏—Å—Ç–∞—è –∫–∏—Ä–∏–ª–ª–∏—Ü–∞
"""–¢–µ—Å—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏."""  # –Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ —Å–∏–º–≤–æ–ª—ã

# –í–∞—Ä–∏–∞–Ω—Ç 3: –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (–ù–ï —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```

## ‚öôÔ∏è **–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ —É–ª—É—á—à–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏**

### 1. –û–±–Ω–æ–≤–∏—Ç—å `.pre-commit-config.yaml`

```yaml
# –î–æ–±–∞–≤–∏—Ç—å MyPy –æ–±—Ä–∞—Ç–Ω–æ —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
- repo: https://github.com/pre-commit/mirrors-mypy
  rev: v1.13.0
  hooks:
    - id: mypy
      additional_dependencies:
        - types-redis
        - types-requests
        - sqlalchemy[mypy]
        - pydantic
      args: ["--ignore-missing-imports", "--no-strict-optional"]
      exclude: ^(tests/|migrations/|scripts/)

# –î–æ–±–∞–≤–∏—Ç—å Safety –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- repo: https://github.com/pyupio/safety
  rev: 3.2.11
  hooks:
    - id: safety
      args: ["--ignore=70612", "--short-report"]

# –ò—Å–ø—Ä–∞–≤–∏—Ç—å prettier (–µ—Å–ª–∏ –Ω—É–∂–µ–Ω)
- repo: https://github.com/pre-commit/mirrors-prettier
  rev: v3.0.0 # —Å—Ç–∞–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è
  hooks:
    - id: prettier
      types_or: [javascript, jsx, ts, tsx, json, yaml, markdown]
      exclude: ^(docs/|htmlcov/|reports/)
```

### 2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∏—Å–∫–ª—é—á–µ–Ω–∏—è –¥–ª—è —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞

```toml
# –í pyproject.toml
[tool.ruff.lint]
ignore = [
    # ... existing ignores ...
    "RUF002",  # –í—Ä–µ–º–µ–Ω–Ω–æ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–∏—Ä–∏–ª–ª–∏—á–µ—Å–∫–∏–µ —Å–∏–º–≤–æ–ª—ã –≤ docstrings
    "RUF003",  # –í—Ä–µ–º–µ–Ω–Ω–æ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–∏—Ä–∏–ª–ª–∏—á–µ—Å–∫–∏–µ —Å–∏–º–≤–æ–ª—ã –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö
]

[tool.ruff.lint.per-file-ignores]
"tests/**/*.py" = [
    # ... existing ignores ...
    "S106",   # –•–∞—Ä–¥–∫–æ–¥ –ø–∞—Ä–æ–ª–µ–π –≤ —Ç–µ—Å—Ç–∞—Ö —Ä–∞–∑—Ä–µ—à–µ–Ω
    "RUF002", # –ö–∏—Ä–∏–ª–ª–∏—Ü–∞ –≤ —Ç–µ—Å—Ç–∞—Ö —Ä–∞–∑—Ä–µ—à–µ–Ω–∞
    "RUF003", # –ö–∏—Ä–∏–ª–ª–∏—Ü–∞ –≤ —Ç–µ—Å—Ç–∞—Ö —Ä–∞–∑—Ä–µ—à–µ–Ω–∞
]
```

### 3. –î–æ–±–∞–≤–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª–µ–∑–Ω—ã–µ —Ö—É–∫–∏

```yaml
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- repo: https://github.com/Lucas-C/pre-commit-hooks
  rev: v1.5.4
  hooks:
    - id: remove-crlf
    - id: remove-tabs

# –ü—Ä–æ–≤–µ—Ä–∫–∞ YAML/JSON
- repo: https://github.com/adrienverge/yamllint
  rev: v1.35.1
  hooks:
    - id: yamllint
      args: [-c=.yamllint.yml]

# –ü—Ä–æ–≤–µ—Ä–∫–∞ Docker —Ñ–∞–π–ª–æ–≤
- repo: https://github.com/hadolint/hadolint
  rev: v2.12.0
  hooks:
    - id: hadolint
      args: [--ignore, DL3008, --ignore, DL3009]
```

## üéØ **–ü–ª–∞–Ω –ø–æ—ç—Ç–∞–ø–Ω–æ–≥–æ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è**

### –≠—Ç–∞–ø 1: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (1-2 –¥–Ω—è)

1. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å MD5** –≤ `src/realtime/models.py`
2. **–î–æ–±–∞–≤–∏—Ç—å –∏–≥–Ω–æ—Ä—ã** –¥–ª—è –∫–∏—Ä–∏–ª–ª–∏—Ü—ã –≤ `pyproject.toml`
3. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ** (F841)
4. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –∏–º–µ–Ω–∞** (F821)

### –≠—Ç–∞–ø 2: –£–ª—É—á—à–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (3-5 –¥–Ω–µ–π)

1. **–í–µ—Ä–Ω—É—Ç—å MyPy** —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
2. **–î–æ–±–∞–≤–∏—Ç—å Safety** –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
3. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å Prettier** –∏–ª–∏ –Ω–∞–π—Ç–∏ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—É
4. **–î–æ–±–∞–≤–∏—Ç—å yamllint** –¥–ª—è YAML —Ñ–∞–π–ª–æ–≤

### –≠—Ç–∞–ø 3: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (1-2 –Ω–µ–¥–µ–ª–∏)

1. **–ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –∏—Å–ø—Ä–∞–≤–ª—è—Ç—å –∫–∏—Ä–∏–ª–ª–∏—Ü—É** –≤ –∫–æ–¥–µ
2. **–î–æ–±–∞–≤–∏—Ç—å —Ö—É–∫–∏ –¥–ª—è Docker** —Ñ–∞–π–ª–æ–≤
3. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å pre-push —Ö—É–∫–∏** –¥–ª—è –±–æ–ª–µ–µ —Ç—è–∂–µ–ª—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫
4. **–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å CI/CD**

## üìù **–ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è**

### 1. –ò—Å–ø—Ä–∞–≤–∏—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫—É—é –ø—Ä–æ–±–ª–µ–º—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

```bash
# –ò—Å–ø—Ä–∞–≤–∏—Ç—å MD5 –≤ realtime/models.py
sed -i 's/hashlib.md5(data)/hashlib.md5(data, usedforsecurity=False)/' src/realtime/models.py
```

### 2. –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Ruff

```bash
# –î–æ–±–∞–≤–∏—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–≥–Ω–æ—Ä—ã –¥–ª—è –∫–∏—Ä–∏–ª–ª–∏—Ü—ã
cat >> pyproject.toml << 'EOF'

[tool.ruff.lint.extend-ignore]
"tests/**/*.py" = ["S106", "RUF002", "RUF003"]
EOF
```

### 3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–º–∞–Ω–¥—ã –≤ Makefile

```makefile
# –î–æ–±–∞–≤–ª–µ–Ω–æ –≤ Makefile:
pre-commit-install:  # ‚úÖ –£–∂–µ –µ—Å—Ç—å
pre-commit-run:      # ‚úÖ –£–∂–µ –µ—Å—Ç—å
pre-commit-fix:      # –î–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
    @echo "üîß –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è..."
    uv run ruff check src/ tests/ scripts/ --fix
    uv run ruff format src/ tests/ scripts/
    uv run isort src/ tests/ scripts/
```

## üîç **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –º–µ—Ç—Ä–∏–∫–∏**

### –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ:

- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫ Ruff** (—Ü–µ–ª—å: <50)
- **–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ö—É–∫–æ–≤** (—Ü–µ–ª—å: <2 –º–∏–Ω—É—Ç)
- **–ü—Ä–æ—Ü–µ–Ω—Ç –∞–≤—Ç–æ–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π** (—Ü–µ–ª—å: >80%)
- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö —Ö—É–∫–æ–≤** (—Ü–µ–ª—å: 0)

### –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:

```bash
# –í GitHub Actions –∏–ª–∏ Slack
if [ $ruff_errors -gt 100 ]; then
    echo "‚ö†Ô∏è –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –æ—à–∏–±–æ–∫ Ruff: $ruff_errors"
fi
```

## üéõÔ∏è **–ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è –∫–æ–º–∞–Ω–¥—ã**

### –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

```yaml
# .pre-commit-config-strict.yaml (–¥–ª—è –ª–∏–¥–æ–≤)
# –í–∫–ª—é—á–∞–µ—Ç –≤—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏

# .pre-commit-config-basic.yaml (–¥–ª—è –¥–∂—É–Ω–∏–æ—Ä–æ–≤)
# –¢–æ–ª—å–∫–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏
```

### –û–±—É—á–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã

1. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** - –æ–±–Ω–æ–≤–∏—Ç—å README —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏
2. **–í–æ—Ä–∫—à–æ–ø—ã** - –ø—Ä–æ–≤–µ—Å—Ç–∏ —Å–µ—Å—Å–∏—é –ø–æ pre-commit
3. **–ß–∞—Ç-–±–æ—Ç** - –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–æ–¥—Å–∫–∞–∑–∫–∏ –≤ Slack/Teams

## üîÆ **–ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è**

### –ß–µ—Ä–µ–∑ 1-2 –º–µ—Å—è—Ü–∞:

- **–°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ö—É–∫–∏** –¥–ª—è —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫ –ø—Ä–æ–µ–∫—Ç–∞
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å SonarQube/CodeClimate**
- **A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** —Ä–∞–∑–Ω—ã—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ MR** –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

### –ß–µ—Ä–µ–∑ 3-6 –º–µ—Å—è—Ü–µ–≤:

- **ML-based –∫–æ–¥-—Ä–µ–≤—å—é** –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- **Performance regression** —Ç–µ—Å—Ç—ã –≤ pre-commit
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è** –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏–∑ –∫–æ–¥–∞
- **–ö—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω—ã–µ** —Ö—É–∫–∏ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π

---

## üí° **–ó–∞–∫–ª—é—á–µ–Ω–∏–µ**

Pre-commit —Ö–æ—Ä–æ—à–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç! –û—Å–Ω–æ–≤–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

1. **üö® –°—Ä–æ—á–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å MD5** - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è —É—è–∑–≤–∏–º–æ—Å—Ç—å
2. **üìù –î–æ–±–∞–≤–∏—Ç—å –∏–≥–Ω–æ—Ä—ã –¥–ª—è –∫–∏—Ä–∏–ª–ª–∏—Ü—ã** - –≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ
3. **üîß –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –æ—Ç–∫–ª—é—á–µ–Ω–Ω—ã–µ —Ö—É–∫–∏** - MyPy, Safety
4. **üìä –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞
5. **üë• –û–±—É—á–∏—Ç—å –∫–æ–º–∞–Ω–¥—É** best practices

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è, –±–µ–∑–æ–ø–∞—Å–Ω–∞—è –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∫–æ–Ω—Ç—Ä–æ–ª—è –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞!
